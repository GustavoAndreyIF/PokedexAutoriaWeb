<!DOCTYPE html>
<html lang="pt-BR">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Pok√©dex - Detalhes</title>

		<!-- Bootstrap 5 CSS -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
			rel="stylesheet"
		/>

		<!-- CSS personalizado (apenas cores dos tipos) -->
		<link href="style.css" rel="stylesheet" />
	</head>
	<body class="bg-light">
		<!-- Header da aplica√ß√£o -->


		<!-- Conte√∫do principal -->
		<main class="container">
			<!-- Loading State -->
			<div class="text-center py-5" id="loading-state">
				<div
					class="spinner-border text-primary mb-3"
					style="width: 3rem; height: 3rem"
					role="status"
				>
					<span class="visually-hidden">Carregando...</span>
				</div>
				<h4 class="text-muted">Carregando detalhes do Pok√©mon...</h4>
			</div>

			<!-- Error State -->
			<div
				class="alert alert-danger rounded-4 text-center mx-auto"
				style="max-width: 600px; display: none"
				id="error-state"
			>
				<i class="fas fa-exclamation-triangle fa-2x mb-3"></i>
				<h4>Erro ao carregar Pok√©mon</h4>
				<p class="mb-3">
					N√£o foi poss√≠vel carregar os detalhes do Pok√©mon solicitado.
				</p>
				<div class="d-flex gap-2 justify-content-center flex-wrap">
					<button
						class="btn btn-danger rounded-pill px-3"
						onclick="location.reload()"
					>
						<i class="fas fa-redo me-2"></i>Tentar Novamente
					</button>
					<a href="index.html" class="btn btn-secondary rounded-pill px-3">
						<i class="fas fa-home me-2"></i>Voltar ao In√≠cio
					</a>
				</div>
			</div>

			<!-- Pokemon Details (hidden initially) -->
			<div id="pokemon-details" style="display: none">
				<!-- Main Pokemon Card -->
				<div class="card shadow border-0 rounded-4 mb-4">
					<div
						class="bg-gradient-purple text-white rounded-top-4 p-4 text-center position-relative"
					>
						<div class="position-absolute top-0 end-0 mt-3 me-3">
							<span
								class="badge bg-white bg-opacity-20 fs-6 px-3 py-2"
								id="pokemon-id-badge"
							>
								#001
							</span>
						</div>
						<img
							id="pokemon-main-sprite"
							src=""
							alt=""
							class="img-fluid mb-3"
							style="
								width: 200px;
								height: 200px;
								object-fit: contain;
								filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
							"
						/>
						<h1
							class="display-5 fw-bold mb-2 text-capitalize"
							id="pokemon-name"
						>
							Nome
						</h1>
						<div
							id="pokemon-types"
							class="d-flex justify-content-center gap-2 flex-wrap"
						>
							<!-- Types will be inserted here -->
						</div>
					</div>

					<div class="card-body p-4">
						<!-- Pokemon Description -->
						<div
							class="bg-light rounded-3 p-3 mb-4 border-start border-primary border-4"
						>
							<p
								class="mb-0 fst-italic text-muted fs-5"
								id="pokemon-description"
							>
								Carregando descri√ß√£o...
							</p>
						</div>

						<!-- Pokemon Stats Grid -->
						<div class="row g-4">
							<!-- Basic Info -->
							<div class="col-md-6">
								<div class="card border-0 shadow-sm h-100">
									<div class="card-header bg-primary text-white">
										<h5 class="mb-0">
											<i class="fas fa-info-circle me-2"></i
											>Informa√ß√µes B√°sicas
										</h5>
									</div>
									<div class="card-body">
										<ul class="list-unstyled mb-0" id="basic-info">
											<!-- Basic info will be inserted here -->
										</ul>
									</div>
								</div>
							</div>

							<!-- Abilities -->
							<div class="col-md-6">
								<div class="card border-0 shadow-sm h-100">
									<div class="card-header bg-success text-white">
										<h5 class="mb-0">
											<i class="fas fa-star me-2"></i>Habilidades
										</h5>
									</div>
									<div class="card-body">
										<div
											id="abilities-list"
											class="d-flex flex-wrap gap-2"
										>
											<!-- Abilities will be inserted here -->
										</div>
									</div>
								</div>
							</div>

							<!-- Base Stats -->
							<div class="col-12">
								<div class="card border-0 shadow-sm">
									<div class="card-header bg-warning text-dark">
										<h5 class="mb-0">
											<i class="fas fa-chart-bar me-2"></i
											>Estat√≠sticas Base
										</h5>
									</div>
									<div class="card-body">
										<div id="base-stats">
											<!-- Stats will be inserted here -->
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</main>

        		<!-- Rodap√© -->
		<footer>
			<div class="bg-dark text-white py-3">
				<div class="container text-center">
					<p class="mb-0">
						Copyright &copy; 2025 GustavoAndreyIF, Leonardo1234321, TrojanN63
					</p>
					<p class="mb-0">
						Desenvolvido por <a href="https://github.com/GustavoAndreyIF" target="_blank">Gustavo Andrey</a>
						<a href="https://github.com/Leonardo1234321" target="_blank">Leonardo Furtado</a>
						<a href="https://github.com/TrojanN63" target="_blank">Arthur Alves</a>
					</p>
					<p class="mb-0">Link da API: <a href="https://pokeapi.co/" target="_blank">https://pokeapi.co/</a></p>
				</div>
			</div>
		</footer>

		<!-- Bootstrap 5 JS -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

		<!-- JavaScript da aplica√ß√£o -->
		<script type="module" src="main.js"></script>

		<script>
			// =============================================================================
			// INTEGRA√á√ÉO SIMPLIFICADA - APENAS INICIALIZA√á√ÉO
			// =============================================================================

			console.log("üöÄ INICIALIZANDO P√ÅGINA DE DETALHES");

			// Fun√ß√£o para mostrar loading
			function showLoading() {
				const loadingState = document.getElementById("loading-state");
				const errorState = document.getElementById("error-state");
				const pokemonDetails = document.getElementById("pokemon-details");
				
				if (loadingState) loadingState.style.display = "block";
				if (errorState) errorState.style.display = "none";
				if (pokemonDetails) pokemonDetails.style.display = "none";
			}

			// Fun√ß√£o para mostrar erro
			function showError(message) {
				const loadingState = document.getElementById("loading-state");
				const errorState = document.getElementById("error-state");
				const pokemonDetails = document.getElementById("pokemon-details");
				
				if (loadingState) loadingState.style.display = "none";
				if (errorState) {
					errorState.style.display = "block";
					const errorText = errorState.querySelector("p");
					if (errorText) errorText.textContent = message;
				}
				if (pokemonDetails) pokemonDetails.style.display = "none";
			}

			// Aguardar carregamento do main.js
			window.addEventListener("load", async () => {
				try {
					// Obter ID do Pokemon da URL
					const urlParams = new URLSearchParams(window.location.search);
					const pokemonId = urlParams.get("id");

					if (!pokemonId) {
						throw new Error("ID do Pok√©mon n√£o encontrado na URL");
					}

					// Mostrar loading
					showLoading();

					// Aguardar que as fun√ß√µes do main.js estejam dispon√≠veis
					let attempts = 0;
					const maxAttempts = 50; // 5 segundos

					while (
						typeof initializePokemonDetails === "undefined" &&
						attempts < maxAttempts
					) {
						await new Promise((resolve) => setTimeout(resolve, 100));
						attempts++;
					}

					if (typeof initializePokemonDetails === "undefined") {
						throw new Error("main.js n√£o foi carregado corretamente");
					}

					// Carregar detalhes do Pokemon (toda a renderiza√ß√£o √© feita pelo PokemonDetails.js)
					const result = await initializePokemonDetails(pokemonId);

					if (!result.success) {
						throw new Error(result.error || "Falha ao carregar detalhes");
					}

				} catch (error) {
					console.error("‚ùå Erro na p√°gina de detalhes:", error);
					showError(error.message);
				}
			});

			console.log("üîç P√°gina de detalhes configurada com sucesso!");
		</script>
	</body>
</html>
